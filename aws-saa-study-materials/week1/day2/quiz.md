# Day 2 퀴즈: AWS IAM (Identity and Access Management)

## 퀴즈 개요
- **총 문제 수**: 5문제
- **예상 소요 시간**: 10-15분
- **난이도**: 중급
- **주제**: IAM 사용자, 그룹, 역할, 정책, 보안 모범 사례

---

## 문제 1: IAM 기본 개념 (객관식)

AWS IAM에서 **역할(Role)**과 **사용자(User)**의 가장 중요한 차이점은 무엇입니까?

**A)** 역할은 영구적인 자격 증명을 가지고, 사용자는 임시 자격 증명을 가진다  
**B)** 사용자는 영구적인 자격 증명을 가지고, 역할은 임시 자격 증명을 제공한다  
**C)** 역할은 사람만 사용할 수 있고, 사용자는 AWS 서비스만 사용할 수 있다  
**D)** 역할과 사용자는 기능적으로 동일하며 단지 이름만 다르다  

<details>
<summary><strong>정답 및 해설</strong></summary>

**정답: B) 사용자는 영구적인 자격 증명을 가지고, 역할은 임시 자격 증명을 제공한다**

**해설:**
- **사용자(User)**: 영구적인 자격 증명(비밀번호, 액세스 키)을 가지며, 주로 개별 사람이나 애플리케이션을 나타냅니다.
- **역할(Role)**: 영구적인 자격 증명이 없으며, 필요할 때 임시 보안 자격 증명을 제공합니다. AWS 서비스, 다른 AWS 계정, 또는 외부 사용자가 "assume"하여 사용할 수 있습니다.

이 차이점은 보안 측면에서 매우 중요합니다. 역할을 사용하면 장기간 유효한 자격 증명을 관리할 필요가 없어 보안 위험을 줄일 수 있습니다.
</details>

---

## 문제 2: 정책 평가 로직 (시나리오 기반)

다음 상황에서 사용자 Alice의 S3 버킷 접근 권한을 평가해보세요:

**상황:**
- Alice는 `Developers` 그룹에 속해 있음
- `Developers` 그룹에는 `AmazonS3ReadOnlyAccess` 정책이 연결됨
- Alice 개인에게는 다음 인라인 정책이 직접 연결됨:
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Deny",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::confidential-bucket/*"
    }
  ]
}
```

Alice가 `confidential-bucket`에서 객체를 읽으려고 할 때 결과는?

**A)** 허용됨 - 그룹 정책이 개인 정책보다 우선함  
**B)** 거부됨 - 명시적 거부가 모든 허용보다 우선함  
**C)** 허용됨 - ReadOnlyAccess 정책이 더 광범위한 권한을 제공함  
**D)** 오류 발생 - 정책 충돌로 인해 요청을 처리할 수 없음  

<details>
<summary><strong>정답 및 해설</strong></summary>

**정답: B) 거부됨 - 명시적 거부가 모든 허용보다 우선함**

**해설:**
AWS IAM의 정책 평가 로직은 다음과 같습니다:
1. **기본적으로 거부**: 명시적 허용이 없으면 거부
2. **명시적 거부가 최우선**: `"Effect": "Deny"`가 있으면 무조건 거부
3. **명시적 허용**: 거부가 없고 허용이 있으면 허용

이 경우:
- 그룹 정책에서 S3 읽기를 허용하지만
- 개인 인라인 정책에서 `confidential-bucket`에 대한 `s3:GetObject`를 명시적으로 거부
- **명시적 거부가 항상 우선**하므로 접근이 거부됩니다

이는 보안을 강화하기 위한 설계로, 실수로 과도한 권한이 부여되는 것을 방지합니다.
</details>

---

## 문제 3: IAM 모범 사례 (다중 선택)

다음 중 IAM 보안 모범 사례에 해당하는 것들을 **모두** 선택하세요:

**A)** Root 계정에 MFA(Multi-Factor Authentication)를 활성화한다  
**B)** 모든 사용자가 동일한 액세스 키를 공유하여 관리를 단순화한다  
**C)** 최소 권한 원칙에 따라 필요한 최소한의 권한만 부여한다  
**D)** 액세스 키를 정기적으로 로테이션한다  
**E)** 개발, 테스트, 운영 환경에서 동일한 IAM 사용자를 사용한다  

<details>
<summary><strong>정답 및 해설</strong></summary>

**정답: A, C, D**

**해설:**
- **A) ✅ 올바름**: Root 계정은 모든 권한을 가지므로 MFA 활성화는 필수입니다.
- **B) ❌ 틀림**: 액세스 키 공유는 보안 위험을 증가시킵니다. 각 사용자는 개별 자격 증명을 가져야 합니다.
- **C) ✅ 올바름**: 최소 권한 원칙은 IAM의 핵심 보안 원칙입니다.
- **D) ✅ 올바름**: 정기적인 액세스 키 로테이션은 보안 침해 위험을 줄입니다.
- **E) ❌ 틀림**: 환경별로 분리된 IAM 사용자/역할을 사용해야 합니다.

**추가 모범 사례:**
- 개별 IAM 사용자 생성 (공유 계정 금지)
- 그룹을 통한 권한 관리
- CloudTrail을 통한 API 호출 모니터링
- 정기적인 권한 검토 및 불필요한 권한 제거
</details>

---

## 문제 4: 실제 시나리오 적용 (서술형)

**시나리오:**
당신은 스타트업의 DevOps 엔지니어입니다. 회사에는 다음과 같은 팀 구조가 있습니다:
- **개발팀 (3명)**: EC2, S3, CloudWatch에 대한 읽기/쓰기 권한 필요
- **QA팀 (2명)**: 모든 서비스에 대한 읽기 전용 권한 필요  
- **관리팀 (1명)**: 비용 관리 및 빌링 정보 접근 권한 필요

이 요구사항을 만족하는 IAM 구조를 설계하고, 각 팀에 적절한 정책을 제안하세요.

<details>
<summary><strong>예시 답안 및 해설</strong></summary>

**제안하는 IAM 구조:**

### 1. IAM 그룹 생성
```
- Developers (개발팀)
- QA-Team (QA팀)  
- Finance-Team (관리팀)
```

### 2. 각 그룹별 정책 연결

**Developers 그룹:**
- `AmazonEC2FullAccess`
- `AmazonS3FullAccess`
- `CloudWatchFullAccess`
- 또는 커스텀 정책으로 특정 리소스만 접근 허용

**QA-Team 그룹:**
- `ReadOnlyAccess` (모든 AWS 서비스 읽기 전용)
- 또는 개별 서비스별 ReadOnly 정책들

**Finance-Team 그룹:**
- `Billing` (빌링 정보 접근)
- `AWSBillingReadOnlyAccess`
- `AWSBudgetsReadOnlyAccess`

### 3. 사용자 생성 및 그룹 할당
각 팀원별로 개별 IAM 사용자 생성 후 해당 그룹에 할당

### 4. 보안 강화 방안
- 모든 사용자에게 MFA 강제 적용
- 강력한 비밀번호 정책 설정
- 액세스 키는 필요한 경우에만 생성
- CloudTrail을 통한 활동 모니터링

**설계 원칙:**
- **최소 권한**: 각 팀이 업무에 필요한 최소한의 권한만 부여
- **그룹 기반 관리**: 개별 사용자가 아닌 그룹을 통한 권한 관리
- **환경 분리**: 개발/스테이징/프로덕션 환경별 별도 계정 고려
</details>

---

## 문제 5: 고급 IAM 개념 (객관식)

EC2 인스턴스가 S3 버킷에 접근해야 하는 상황에서, 가장 안전하고 권장되는 방법은 무엇입니까?

**A)** EC2 인스턴스에 IAM 사용자의 액세스 키를 하드코딩한다  
**B)** EC2 인스턴스에 IAM 역할을 연결하고 인스턴스 프로파일을 사용한다  
**C)** EC2 인스턴스의 사용자 데이터에 액세스 키를 포함시킨다  
**D)** 애플리케이션 코드에 액세스 키를 환경 변수로 설정한다  

<details>
<summary><strong>정답 및 해설</strong></summary>

**정답: B) EC2 인스턴스에 IAM 역할을 연결하고 인스턴스 프로파일을 사용한다**

**해설:**

**올바른 방법 (B):**
- **IAM 역할**: S3 접근 권한을 가진 역할 생성
- **인스턴스 프로파일**: 역할을 EC2 인스턴스에 연결하는 메커니즘
- **임시 자격 증명**: AWS SDK가 자동으로 임시 자격 증명을 획득하고 갱신
- **보안 장점**: 장기간 유효한 자격 증명이 인스턴스에 저장되지 않음

**잘못된 방법들:**
- **A, C, D**: 모두 액세스 키를 인스턴스나 코드에 저장하는 방식
- **보안 위험**: 액세스 키 노출, 키 로테이션 어려움, 감사 추적 복잡

**실제 구현 과정:**
1. S3 접근 권한을 가진 IAM 역할 생성
2. EC2 인스턴스 시작 시 역할 연결
3. 애플리케이션에서 AWS SDK 사용 (자격 증명 명시 불필요)
4. SDK가 자동으로 인스턴스 메타데이터에서 임시 자격 증명 획득

이 방법은 AWS의 보안 모범 사례이며, 다른 AWS 서비스(Lambda, ECS 등)에서도 동일한 원칙이 적용됩니다.
</details>

---

## 퀴즈 완료 후 체크리스트

다음 개념들을 이해했는지 확인해보세요:

- [ ] IAM 사용자, 그룹, 역할, 정책의 차이점과 용도
- [ ] AWS 정책 평가 로직 (명시적 거부 우선 원칙)
- [ ] IAM 보안 모범 사례 (MFA, 최소 권한, 키 로테이션 등)
- [ ] 실제 조직 구조에 맞는 IAM 설계 방법
- [ ] EC2와 다른 AWS 서비스 간 안전한 통신 방법 (역할 사용)

---

## 추가 학습 자료

### 복습이 필요한 경우
- AWS IAM 사용 설명서: https://docs.aws.amazon.com/iam/
- IAM 모범 사례: https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html
- IAM 정책 시뮬레이터: https://policysim.aws.amazon.com/

### 심화 학습
- AWS STS (Security Token Service)
- Cross-account access 설정
- SAML 및 OpenID Connect 연동
- AWS Organizations와 SCP (Service Control Policies)

---

## 점수 계산

- **5문제 모두 정답**: 🏆 완벽! IAM 개념을 잘 이해하고 있습니다.
- **4문제 정답**: 👍 우수! 한 가지 개념을 더 복습해보세요.
- **3문제 정답**: 📚 양호! 틀린 부분을 다시 학습하고 실습해보세요.
- **2문제 이하**: 🔄 복습 필요! 이론 내용과 실습을 다시 진행해보세요.

**다음 단계**: 내일은 EC2 서비스를 학습하면서 오늘 배운 IAM 역할을 실제로 EC2 인스턴스에 연결하는 실습을 진행합니다!